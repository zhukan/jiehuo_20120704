o: ActiveSupport::Cache::Entry	:@compressedF:@expires_in0:@created_atf1341374994.668226:@value{I"
class:EFI"BundledAsset;
FI"id;
F"%dae7091b1fa7cadd8761377d884f50ccI"logical_path;
F"asks.jsI"pathname;
FI")$root/app/assets/javascripts/asks.js;
FI"content_type;
FI"application/javascript;
FI"
mtime;
FI"2012-07-04T12:04:58+08:00;
FI"	body;
FI"Z7//æ§ä»¶éªŒè¯ï¼šç­”æ¡ˆï¼šå¦‚æœç”¨æˆ·æ²¡æœ‰å¡«å†™é¢˜å‹çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆç³»ç»Ÿè®¤ä¸ºç”¨æˆ·ä¸çŸ¥é“ç­”æ¡ˆï¼Œç³»ç»Ÿå°†â€œæˆ‘ä¸çŸ¥é“ç­”æ¡ˆâ€é¡¹å­˜å…¥æ•°æ®åº“ä¸­
$(function(){
    //åˆå§‹åŒ–é¡µé¢
    //1ï¼‰é¢˜å‹é»˜è®¤é€‰æ‹©å•é€‰é¢˜
    $('#ask_ask_type_1').attr("checked",true);

    //æ§ä»¶éªŒè¯ï¼šæ¯ä¸ªé—®é¢˜å¿…é¡»æœ‰å¯¹åº”çš„çŸ¥è¯†ç‚¹
    //valueï¼šæ£€æµ‹çš„å¯¹è±¡çš„å€¼
    //elementï¼šæ£€æµ‹çš„å¯¹è±¡
    //æ£€æµ‹æ–¹æ³•ï¼šæ£€æµ‹éšè—åŸŸä¸­æ˜¯å¦æœ‰nameå±æ€§å½¢å¦‚ï¼ˆsection_hidden[8]ï¼‰
    $(":submit[id=tijiao]").click(function(check){
        //æ‰¾åˆ°section_ulä¸‹çš„æ‰€æœ‰input hiddenå…ƒç´ 
        var section_hidden =  $("#section_ul input:hidden");

        //å¦‚æœæ²¡æœ‰input hiddenå…ƒç´ åˆ™ç¦æ­¢æäº¤
        if (section_hidden.length == 0){
            //æ˜¾ç¤ºç¦æ­¢æäº¤æç¤º
            $('#validate_section').attr("style","display: block;");
            check.preventDefault();
        }else{
           //å¦‚æœå­˜åœ¨input hiddenåˆ™åˆ¤æ–­hiddenå…ƒç´ ä¸Šæ˜¯å¦å­˜åœ¨åå­—ä»¥section_hiddençš„å…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰ä»£è¡¨æ²¡æœ‰é€‰æ‹©ä»»ä½•çŸ¥è¯†ç‚¹ï¼Œç¦æ­¢æäº¤
           if($("#section_ul input[name^='section_hidden']").length==0){
               $('#validate_section').attr("style","display: block;");
               check.preventDefault();
           }
        }
    });

    //æ§ä»¶éªŒè¯ï¼šå½“Fé€‰é¡¹æœ‰å€¼æ—¶ï¼ŒEé€‰é¡¹ä¸èƒ½ä¸ºç©º
    $("#xuanxiang_f").blur(function() {
        $("#xuanxiang_e").valid();
    });

    $("#new_ask").validate({
        //debug:true,
        rules:{
            "ask[body]":{
               required:true,
               maxlength:500
            },
            // 1ï¼‰å½“é¢˜å‹ä¸ºå•é€‰é¢˜æˆ–è€…å¤šé€‰é¢˜æ—¶ï¼ŒA,B,C,D 4ä¸ªé€‰é¡¹ä¸èƒ½ä¸ºç©º
            "xuanxiang[a]":{
               required: true,
               maxlength:200
            },
            "xuanxiang[b]":{
               required:true,
               maxlength:200
            },
            "xuanxiang[c]":{
               required:true,
                maxlength:200
            },
            "xuanxiang[d]":{
               required:true,
                maxlength:200
            },
            // 2ï¼‰å½“Fé€‰é¡¹æœ‰å€¼æ—¶ï¼ŒEé€‰é¡¹ä¸èƒ½ä¸ºç©º
            "xuanxiang[e]":{
                required: function (element) {
                  var el_value =  $("#xuanxiang_f").val();
                  return $.trim(el_value).length != 0;
                },
                maxlength:200
            },
            "xuanxiang[f]":{
                maxlength:200
            },
            "ask[comment]":{
                maxlength:500
            },
            "ask[image]":{
                //åˆ¤æ–­ä¸Šä¼ çš„å›¾ç‰‡æ ¼å¼æ˜¯ä¸æ˜¯JPG,GIF,PNGä¸­çš„ä¸€ç§ï¼Œå¦‚æœä¸æ˜¯åˆ™æäº¤ä¸æˆåŠŸ
                accept:"jpg|gif|png"
            }
        },
        messages:{
            "ask[body]":{required:"é¢˜ç›®ä¸èƒ½æ²¡æœ‰é¢˜å¹²å“¦ï¼",maxlength:"é¢˜å¹²æœ€å¤šèƒ½è¾“å…¥500ä¸ªä¸­æ–‡å­—å“¦ï¼"},
            "xuanxiang[a]":{required:"Aä¸èƒ½ä¸ºç©º",maxlength:"é€‰é¡¹èƒ½è¾“å…¥200ä¸ªä¸­æ–‡å­—å“¦ï¼"},
            "xuanxiang[b]":{required:"Bä¸èƒ½ä¸ºç©º",maxlength:"é€‰é¡¹èƒ½è¾“å…¥200ä¸ªä¸­æ–‡å­—å“¦ï¼"},
            "xuanxiang[c]":{required:"Cä¸èƒ½ä¸ºç©º",maxlength:"é€‰é¡¹èƒ½è¾“å…¥200ä¸ªä¸­æ–‡å­—å“¦ï¼"},
            "xuanxiang[d]":{required:"Dä¸èƒ½ä¸ºç©º",maxlength:"é€‰é¡¹èƒ½è¾“å…¥200ä¸ªä¸­æ–‡å­—å“¦ï¼"},
            "xuanxiang[e]":{required:"Eä¸èƒ½ä¸ºç©º",maxlength:"é€‰é¡¹èƒ½è¾“å…¥200ä¸ªä¸­æ–‡å­—å“¦ï¼"},
            "xuanxiang[f]":{maxlength:"é€‰é¡¹èƒ½è¾“å…¥200ä¸ªä¸­æ–‡å­—å“¦ï¼"},
            "ask[comment]":{maxlength:"é€‰é¡¹èƒ½è¾“å…¥500ä¸ªä¸­æ–‡å­—å“¦ï¼"},
            "ask[image]":{accept:"ä½ ä¸Šä¼ çš„å›¾ç‰‡é”™äº†ï¼Œä»…æ”¯æŒJPG,GIF,PNGå›¾ç‰‡æ–‡ä»¶å“¦ï¼"}
        },
        errorPlacement:function(error,element)
        {
            var t = element.parent();
            element.removeClass("error");
            t.next("div").html(error.html());
            t.next("div").addClass("error1");
            t.next("div").show();
        },
        success: "valid"
    });

});

    function doDomainclicked(var_li) {
    //æ‹¼è£…ç­›é€‰å™¨åç§°ï¼Œç­›é€‰å™¨ç»Ÿä¸€é€‰æ‹©liæ ‡ç­¾id
    li_selector = "#" + var_li.id;
    clearAllStyle(li_selector);
    doClicked(li_selector);

    var a_selector = '';
    //å–å½“å‰LIæ ‡ç­¾ä¸‹çš„Aæ ‡ç­¾ä¸‹çš„éšè—åŸŸèŠ‚ç‚¹å€¼,è¯¥èŠ‚ç‚¹çš„å€¼å°±æ˜¯è¢«é€‰ä¸­çš„çš„domainçš„ID
    var domainValue = $(li_selector).children().children().attr("value");

    if (domainValue != "" && typeof(domainValue) != "undefined") {
        $.get("/asks/get_projects_by_domain/" + domainValue, function (data) {

            $('#projects_ul').html("");
            $('#section_ul').html("");

            for (var i = 0; i < data.length; i++) {
                $("<li onclick='doProjectclicked(this)' id='project_li_" + data[i].project_id + "'><a href='javascript:void(0);' id='project_a_" + data[i].project_id + "'>" + data[i].name + "</a></li>").appendTo($('#projects_ul'));
                a_selector = '#project_a_' + data[i].project_id;
                $("<input type='hidden'" + "value=" + data[i].project_id + ">").appendTo($(a_selector));
            }
        }, "json");
    }
    else return;
}

function doProjectclicked(var_li) {
    li_selector = "#" + var_li.id;
    clearAllStyle(li_selector);
    doClicked(li_selector);
    var a_selector = '';
    var projectValue = $(li_selector).children().children().attr("value");
    if (projectValue != '' && typeof(projectValue) != "undefined") {
        $.get("/asks/get_sections_by_project/" + projectValue, function (sdata) {
            $('#section_ul').html("");
            for (var i = 0; i < sdata.length; i++) {
                $("<li onclick='doSectionClicked(this)' id='section_li_" + sdata[i].section_id + "'><a href='javascript:void(0);' id='section_a_" + sdata[i].section_id + "'>" + sdata[i].name + "</a></li>").appendTo($('#section_ul'));
                a_selector = '#section_a_' + sdata[i].section_id;
                $("<input type='hidden'" + "value=" + sdata[i].section_id +">").appendTo($(a_selector));
            }
        }, "json");
    } else {
        retun;
    }
}

function doSectionClicked(var_li) {
    li_id = $(var_li).attr("id");
    li_id_subs = li_id.substring(11);
    var hidd_name =  "section_hidden["+li_id_subs+"]";

    if ($(var_li).attr("style") == null) {
        $(var_li).css("background", "url(/assets/abg.jpg) no-repeat");
        $(var_li).children().children().attr("name",hidd_name);
        //æ˜¾ç¤ºç¦æ­¢æäº¤æç¤º
        $('#validate_section').attr("style","display: none;");
    } else {
        $(var_li).removeAttr("style");
        $(var_li).children().children().removeAttr("name");
    }
}

function clearAllStyle(var_li){
    //æŸ¥æ‰¾åœ¨åŒä¸€ULä¸­çš„LIï¼Œå¦‚æœæœ‰æ ‡ç­¾styleåˆ™æ¸…é™¤
   ul_selector= '#'+$(var_li).parent().attr("id");
   $(ul_selector).children().removeAttr("style");
}

function doClicked(var_li)
{
    if ($(var_li).attr("style") == null) {
        $(var_li).css("background", "url(/assets/abg.jpg) no-repeat")
    } else {
        $(var_li).removeAttr("style");
    }
}

//å½“ç”¨æˆ·ç‚¹å‡»â€œæ–°å¢é€‰é¡¹â€é“¾æ¥
//æ–°å¢ä¸€ä¸ªé€‰é¡¹ï¼ŒEæˆ–è€…Fï¼Œå¹¶ä¸”åœ¨æœ€æœ‰ä¸€ä¸ªé€‰é¡¹åé¢åŠ ä¸Šâ€œå‡å·â€æŒ‰é’®ï¼Œç”¨æˆ·ç‚¹å‡»è¯¥æŒ‰é’®èƒ½éšè—è¯¥é€‰é¡¹
//å¦‚æœæ–°å¢çš„é€‰é¡¹å·²ç»æ˜¯Fäº†ï¼Œåˆ™éšè—â€œæ·»åŠ é€‰é¡¹â€é“¾æ¥
function add_option(){
    var ask_type = $("input[name='ask[ask_type]']:checked").val();
    if($('#li_e_option').attr("style") != null){
        $('#li_e_option').removeAttr("style");
        $("input[name='xuanxiang[e]']").after('<input type="button" onclick="doRemoveOption(this)" id="btn_remobeOption" class="kuangbtn" name="aaaaa" value=""/>');

        //åœ¨ç­”æ¡ˆä¸‹æ‹‰æ¡†ä¸­æ·»åŠ æ–°çš„é€‰é¡¹
        //å¦‚æœç”¨æˆ·é€‰æ‹©äº†å•é€‰é¢˜åˆ™åœ¨åœ¨å•é€‰ä¸‹æ‹‰æ¡†ä¸­æ·»åŠ æ–°çš„é€‰é¡¹
        //å¦‚æœé€‰æ‹©äº†å¤šé€‰é¢˜åˆ™åœ¨å¤šé€‰é¡¹ä¸­æ·»åŠ æ–°çš„é¡¹
        if(ask_type == 1){
            $("#daan_danxuan_sel").append('<option value="E">E</option>');
        }

        if(ask_type == 2){
            $("#daan_duoxuan").append('<input type="checkbox" value="E"/><a name="E">E</a>');
        }

    }else{
        $('#li_f_option').removeAttr("style");
        $("#btn_remobeOption").remove();
        $("input[name='xuanxiang[f]']").after('<input type="button" onclick="doRemoveOption(this)" id="btn_remobeOption" class="kuangbtn" name="aaaaaa" value=""/>');
        $('#div_add_option').hide();

        if(ask_type == 1){
            $("#daan_danxuan_sel").append('<option value="F">F</option>');
        }

        if(ask_type == 2){
            $("#daan_duoxuan").append('<input type="checkbox" value="F"/><a name="F">F</a>');
        }
    }
}

//ç‚¹å‡»æœ€åä¸€ä¸ªé€‰é¡¹ä¸­çš„å‡å·æŒ‰é’®ï¼Œè‡ªåŠ¨æ¸…ç©ºè¯¥é€‰é¡¹textæ¡†ä¸­çš„å†…å®¹
//å¹¶ä¸”å°†è¯¥Textæ§ä»¶éšè—
//å¹¶ä¸”æ˜¾ç¤ºâ€œæ–°å¢é€‰é¡¹â€é“¾æ¥
function doRemoveOption(val_btn){
   var li_dom = $(val_btn).parent().parent();
   li_dom.hide();
   $(val_btn).prev().attr("value","");
   $(val_btn).remove();
   $('#div_add_option').show();
   if(li_dom.attr("id") === "li_f_option"){
       $("input[name='xuanxiang[e]']").after('<input type="button" onclick="doRemoveOption(this)" id="btn_remobeOption" class="kuangbtn" name="aaaaaa" value=""/>');
   }

   //åˆ é™¤é€‰é¡¹ä¸­çš„é€‰é¡¹çš„åŒæ—¶ï¼Œåˆ é™¤ç­”æ¡ˆä¸­çš„æœ€åä¸€ä¸ªé¡¹
   var ask_type = $("input[name='ask[ask_type]']:checked").val();
    //å•é€‰çš„æƒ…å†µ
    if(ask_type == 1){
        $("#daan_danxuan_sel>option").last().remove();
    }
    //å¤šé€‰çš„æƒ…å†µ
    if(ask_type == 2){
        $("#daan_duoxuan :checkbox").last().remove();
        $("#daan_duoxuan>a").last().remove();
    }
}

function askType_danxuan(){
    //å°†å•é€‰é¢˜çš„ç­”æ¡ˆé¡¹è®¾ç½®æˆå¯è§
    var danxuan = $('#daan_danxuan :input');
    $("#li_e_option").hide();
    $("#xuanxiang_e").val("");
    $("#li_f_option").hide();
    $("#xuanxiang_f").val("");
    $("#div_add_option").show();

    $("#daan_duoxuan").children().each(function(){
        //alert($(this).attr("value"));
        if($(this).attr("value")=="E"||$(this).attr("value")=="F"||$(this).attr("name")=="E"||$(this).attr("name")=="F"){
            $(this).remove();
        }
    });

    danxuan.each(function(i){
        if(this.name==""){
            this.name = "daan[danxuan]";
        }
    });

    $('#daan_danxuan').show();
    //å°†å•é€‰é¢˜çš„é€‰é¡¹åŒºåŸŸåˆ¶æˆå¯è§
    $('#xuanxiang').show();

    //å°†å…¶ä»–é¢˜å‹çš„ç­”æ¡ˆé¡¹è®¾ç½®æˆä¸å¯è§
    $('#daan_duoxuan').hide();
    $('#daan_duoxuan :checkbox').removeAttr("name");

    $('#daan_panduan').hide();
    $('#daan_panduan :input').removeAttr("name");

    $('#daan_jianda').hide();
    $('#daan_jianda :input').removeAttr("name");
}

function askType_duoxuan(){
    //å°†å•é€‰é¢˜çš„ç­”æ¡ˆé¡¹è®¾ç½®æˆå¯è§
    var duoxuan = $('#daan_duoxuan :checkbox');
    $("#li_e_option").hide();
    $("#xuanxiang_e").val("");
    $("#li_f_option").hide();
    $("#xuanxiang_f").val("");
    $("#div_add_option").show();

    $("#daan_danxuan_sel>option").each(function(){
        //alert($(this).attr("value"));
        if($(this).attr("value")=="E"||$(this).attr("value")=="F"){
            $(this).remove();
        }
    });

    duoxuan.each(function(i){
        if(this.name==""){
            this.name = "daan[duoxuan]["+i+"]";
        }
    });

    $('#daan_duoxuan').show();
    //å°†å•é€‰é¢˜çš„é€‰é¡¹åŒºåŸŸåˆ¶æˆå¯è§
    $('#xuanxiang').show();

    //å°†å…¶ä»–é¢˜å‹çš„ç­”æ¡ˆé¡¹è®¾ç½®æˆä¸å¯è§
    $('#daan_danxuan').hide();
    $('#daan_danxuan :input').removeAttr("name");

    $('#daan_panduan').hide();
    $('#daan_panduan :input').removeAttr("name");

    $('#daan_jianda').hide();
    $('#daan_jianda :input').removeAttr("name");
}

function askType_panduan(){
    //å°†åˆ¤æ–­é¢˜çš„ç­”æ¡ˆé¡¹è®¾ç½®æˆå¯è§
    var panduan = $('#daan_panduan :input');
    panduan.each(function(){
        if(this.name==""){
            this.name = "daan[panduan]";
        }
    });
    $('#daan_panduan').show();

    //éšè—é€‰é¡¹åŒº
    $('#xuanxiang').hide();
    //éšè—éåˆ¤æ–­é¢˜çš„ç­”æ¡ˆé¡¹åŒºåŸŸ
    $('#daan_danxuan').hide();
    $('#daan_danxuan :input').removeAttr("name");

    $('#daan_duoxuan').hide();
    $('#daan_duoxuan :checkbox').removeAttr("name");

    $('#daan_jianda').hide();
    $('#daan_jianda :input').removeAttr("name");
}

function askType_jianda(){
    //å°†ç®€ç­”é¢˜çš„ç­”æ¡ˆé¡¹è®¾ç½®æˆå¯è§
    var jianda = $('#daan_jianda :input');
    jianda.each(function(){
        if(this.name==""){
            this.name = "daan[jianda]";
        }
    });

    $('#daan_jianda').show();
    //éšè—é€‰é¡¹åŒº
    $('#xuanxiang').hide();
    //éšè—éåˆ¤æ–­é¢˜çš„ç­”æ¡ˆé¡¹åŒºåŸŸ
    $('#daan_danxuan').hide();
    $('#daan_danxuan :input').removeAttr("name");

    $('#daan_duoxuan').hide();
    $('#daan_duoxuan :checkbox').removeAttr("name");

    $('#daan_panduan').hide();
    $('#daan_panduan :input').removeAttr("name");
}

function do_no_daan(){
    //æ£€æŸ¥no[daan]å•é€‰æ¡†æ˜¯å¦å·²ç»è¢«é€‰æ‹©ï¼Œå¦‚æœæ²¡æœ‰è¢«é€‰æ‹©ï¼Œåˆ™é€‰æ‹©ï¼Œå¹¶ä¸”è®¾ç½®4ä¸ªç­”æ¡ˆç©ºé—´ä¸ºä¸å¯ç”¨
    if($('#no_daan').attr('checked')==undefined)
    {
        //å½“å–æ¶ˆå‹¾é€‰ä¸Šâ€œæˆ‘ä¸çŸ¥é“ç­”æ¡ˆâ€é€‰æ¡†æ—¶
        //é‡æ–°æ¿€æ´»æ‰€æœ‰ç­”æ¡ˆæ§ä»¶
        $('#daan_danxuan :input').attr("disabled",false);
        $('#daan_duoxuan :checkbox').attr("disabled",false);
        $('#daan_panduan :input').attr("disabled",false);
        $('#daan_jianda :input').attr("disabled",false);

    }else{
        //å½“å‹¾é€‰ä¸Šæˆ‘ä¸çŸ¥é“ç­”æ¡ˆé€‰æ¡†æ—¶
        //æ¸…ç©ºæ‰€æœ‰ç­”æ¡ˆæ§ä»¶ä¸­çš„å†…å®¹ï¼Œä½¿å…¶ä¸èƒ½æäº¤åˆ°æœåŠ¡å™¨
        $('#daan_danxuan :input').attr("value","");
        $('#daan_duoxuan :checkbox').removeAttr("checked");
        $('#daan_panduan :input').attr("value","");
        $('#daan_jianda :input').attr("value","");
        //åŒæ—¶ï¼Œå°†ç­”æ¡ˆçš„æ§ä»¶è®¾ç½®æˆä¸å¯ç”¨
        $('#daan_danxuan :input').attr("disabled",true);
        $('#daan_duoxuan :checkbox').attr("disabled",true);
        $('#daan_panduan :input').attr("disabled",true);
        $('#daan_jianda :input').attr("disabled",true);
    }
}







;
;
TI"asset_paths;
F[I")$root/app/assets/javascripts/asks.js;
FI"dependency_paths;
F[{I"	path;
FI")$root/app/assets/javascripts/asks.js;
FI"
mtime;
FIu:	Time„€   :@_zoneI"ä¸­å›½æ ‡å‡†æ—¶é—´;
T:offseti€pI"hexdigest;
F"%070ba82df12fced6435bb702ab8b9a1fI"_version;
F"%46dde6621c301f4928e3b34efee9e3b5